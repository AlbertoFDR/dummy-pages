<!DOCTYPE html>
<html>
	<body>
	
		<h1>Permissions-policy in <b>iframes</b></h1>
		<hr>
		<div id="intro">
			This page loads different pages with same and different origin. Also, uses different permissions-policy. 
			Message:
		</div>
		<hr>
		<div id='iframe'>
		</div>
		<script>
			div = document.getElementById('intro');
			var div_iframe = document.getElementById('iframe');
			// Get the permission for geolocation
			// it will appear a popup
			navigator.geolocation.getCurrentPosition(
				(pos) => {
					console.log(pos.coords);
					p = document.createElement('p');
					div = document.getElementById('intro');
					div.textContent += `Your coords are ${pos.coords.latitude} lat and ${pos.coords.longitude} long.`
				}
			);
	
			// --------------------------------------------------------- Geolocation
			// Create the iframe for the communication
			var iframe = document.createElement('IFRAME');
			iframe.setAttribute("src", "http://localhost:1234/iframes/permissions-policy/_permissions-geolocation-iframe.html");
			iframe.setAttribute("height", "200");
			iframe.setAttribute("width", "400");
			iframe.setAttribute("allow", "geolocation");
			div_iframe.appendChild(iframe);
	
			// --------------------------------------------------------- All permissions
			// Create the iframe for the communication
			var iframe = document.createElement('IFRAME');
			iframe.setAttribute("src", "http://localhost:1234/iframes/permissions-policy/_permissions-all-iframe.html");
			iframe.setAttribute("height", "200");
			iframe.setAttribute("width", "400");
			iframe.setAttribute("allow", "accelerometer; ambient-light-sensor; autoplay; battery camera; display-capture; document-domain; encrypted-media; execution-while-not-rendered; execution-while-out-of-viewport; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; local-fonts; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-create; publickey-credentials-get; screen-wake-lock; serial; speaker-selection; usb; web-share; xr-spatial-tracking");
			div_iframe.appendChild(iframe);
	
			// --------------------------------------------------------- Permission for origin
			// Create the iframe for the communication
			var iframe = document.createElement('IFRAME');
			iframe.setAttribute("src", "http://localhost:5000/iframes/permissions-policy/_permissions-geolocation-iframe.html");
			iframe.setAttribute("height", "200");
			iframe.setAttribute("width", "400");
			// iframe.setAttribute("allow", "geolocation=(http://localhost:5000/)");
			div_iframe.appendChild(iframe);

		</script>
	</body>
</html>
